---
title: "Learner-Simulations"
author: "Manikya Alister"
date: "16/08/2022"
output: 
  html_document:
    theme: simplex
    code_folding: hide
---
```{r setup, include=FALSE}
rm(list = ls())
knitr::opts_chunk$set(echo = TRUE)
library(here)
source(here("functions/heuristic-learner.R"))
source(here("functions/pedagogical-learner.R"))
source(here("functions/generic-functions.R"))
```

## Set up rectangle world 

```{r include = TRUE}
set.seed(123)

# Define range of possible features
range = 1:10

# set up all possible hypotheses
borders = makeBorders(range)

# Define the true category region
trueRectangle = c(4,4,9,9)

#visualize true category region
plot(c(1,max(range)), c(1, max(range)), type= "n", xlab = "", ylab = "")
rect(trueRectangle[1],trueRectangle[2],trueRectangle[3],trueRectangle[4],border = "red", lwd = 3)
```

## Sample some observations

For this simulation I'm going to do a maximum of 10 observations, 5 positive examples and 5 negative examples. I'm interested to see how the different learning strategies (weak, ped, pedagogical) generalise given different quantities of examples (e.g., 1, 3, 5 of each positive/negative evidence type). 

This sampling is, I guess, a form of weak sampling, but it's not truly weak because I'm ensuring an equal number of positive and negative examples. 

```{r echo = TRUE}

obs = sampleRect(5,5,trueRectangle)
# 
# # set up different arrays with different numbers of observations
# obs1 = obs[c(1,6),]
# obs3 = obs[c(1:2,6:7),]
# obs5 = obs[c(1:3,6:8),]


obs1 = rbind(c(10,10,"negative"),c(8.5,8.5,"positive"))
obs3 = rbind(c(10,10,"negative"),c(10,8.5,"negative"),c(8.5,7.5,"positive"),c(8.5,8.5,"positive"))
obs5 = rbind(c(10,10,"negative"),c(10,8.5,"negative"),c(8.5,7.5,"positive"),c(8.5,8.5,"positive"), c(8.5,6.5,"positive"), c(10,6.5,"negative"))

colnames(obs1) = c("x","y","category")
colnames(obs3) = c("x","y","category")
colnames(obs5) = c("x","y","category")


# visualize observations
plot(c(1,max(range)), c(1, max(range)), type= "n", xlab = "", ylab = "", main = "Hypothesis Space, Observations, and True Category Boundary")
rect(trueRectangle[1],trueRectangle[2],trueRectangle[3],trueRectangle[4],border = "red", lwd = 2)
points(obs5)
```

```{r echo = FALSE}
weak1 = pedLearner(borders, obs1, alpha = 0)
weak3 = pedLearner(borders, obs3, alpha = 0)
weak5 = pedLearner(borders, obs5, alpha = 0)
```

```{r echo = FALSE}
ped1 = pedLearner(borders, obs1)
ped3 = pedLearner(borders, obs3)
ped5 = pedLearner(borders, obs5)
```

```{r}
ls1 = heuristicLearner(borders, obs1)
ls3 = heuristicLearner(borders, obs3)
ls5 = heuristicLearner(borders, obs5)
```

```{r}
outer1 = heuristicLearner(borders, obs1, heuristic = "outer")
outer3 = heuristicLearner(borders, obs3, heuristic = "outer")
outer5 = heuristicLearner(borders, obs5, heuristic = "outer")
```

```{r}
dec1 = pedLearner(borders, obs1, alpha = -1)
dec3 = pedLearner(borders, obs3, alpha = -1)
dec5 = pedLearner(borders, obs5, alpha = -1)
```



```{r}
par(omi=rep(0.3, 4), mar=c(1,1,1,1), mfrow=c(3,4))

plotPed(weak1,obs1,trueRectangle)
mtext("Weak Learner", side = 3)

plotPed(ped1, obs1, trueRectangle)
mtext("Pedegogical Learner", side = 3)

plotHeuristic(ls1, obs1, trueRectangle)
mtext("Least Squares Learner", side = 3)

plotHeuristic(outer1, obs1, trueRectangle)
mtext("Outer Learner", side = 3)

plotPed(weak3,obs3,trueRectangle)

plotPed(ped3, obs3, trueRectangle)

plotHeuristic(ls3, obs3, trueRectangle)

plotHeuristic(outer3, obs3, trueRectangle)

plotPed(weak5,obs5,trueRectangle)

plotPed(ped5, obs5, trueRectangle)

plotHeuristic(ls5, obs5, trueRectangle)

plotHeuristic(outer5, obs5, trueRectangle)
```
## 3 best rectangles

```{r}
par(omi=rep(0.3, 4), mar=c(1,1,1,1), mfrow=c(3,4))

plotPed(weak1,obs1,trueRectangle,nHypotheses = 3)
mtext("Weak Learner", side = 3)

plotPed(ped1, obs1, trueRectangle, nHypotheses = 3)
mtext("Pedegogical Learner", side = 3)

plotHeuristic(ls1, obs1, trueRectangle, nHypotheses = 3)
mtext("Least Squares Learner", side = 3)

plotHeuristic(outer1, obs1, trueRectangle, nHypotheses = 3)
mtext("Outer Learner", side = 3)

plotPed(weak3,obs3,trueRectangle, nHypotheses = 3)

plotPed(ped3, obs3, trueRectangle, nHypotheses = 3)

plotHeuristic(ls3, obs3, trueRectangle, nHypotheses = 3)

plotHeuristic(outer3, obs3, trueRectangle, nHypotheses = 3)

plotPed(weak5,obs5, trueRectangle, nHypotheses = 3)

plotPed(ped5, obs5, trueRectangle, nHypotheses = 3)

plotHeuristic(ls5, obs5, trueRectangle, nHypotheses = 3)

plotHeuristic(outer5, obs5, trueRectangle, nHypotheses = 3)
```

```{r}
par(omi=rep(0.3, 4), mar=c(1,1,1,1), mfrow=c(3,3))

plotPed(dec1, obs1, trueRectangle, nHypotheses = 3)
mtext("Deceptive (alpha = -1)", side = 3)

plotPed(weak1,obs1,trueRectangle,nHypotheses = 3, sampling = "weak")
mtext("Weak (alpha = 0)", side = 3)

plotPed(ped1, obs1, trueRectangle, nHypotheses = 3)
mtext("Helpful (alpha = 1)", side = 3)

plotPed(dec3, obs3, trueRectangle, nHypotheses = 3)

plotPed(weak3,obs3,trueRectangle, nHypotheses = 3, sampling = "weak")

plotPed(ped3, obs3, trueRectangle, nHypotheses = 3)

plotPed(dec5, obs5, trueRectangle, nHypotheses = 3)

plotPed(weak5,obs5, trueRectangle, nHypotheses = 3, sampling = "weak")

plotPed(ped5, obs5, trueRectangle, nHypotheses = 3)
```


## 1 observation 

```{r}
obs1Pos = c(8,8,"positive")
names(obs1Pos) = c("x","y","category")
obs1Neg = c(2,2,"negative")
names(obs1Neg) = c("x","y","category")

ped1Pos = pedLearner(borders,obs1Pos)
ped1Neg = pedLearner(borders,obs1Neg)

par(omi=rep(0.3, 4), mar=c(1,1,1,1), mfrow=c(1,2))

plotPed(ped1Neg,obs1Neg,trueRectangle, nHypotheses = 3)
plotPed(ped1Pos,obs1Pos,trueRectangle, nHypotheses = 3)

https://www.google.com/url?sa=i&url=https%3A%2F%2Fa-z-animals.com%2Fanimals%2Flion%2F&psig=AOvVaw1Ce4_08kIJSFPhRMOkY3QU&ust=1668572480858000&source=images&cd=vfe&ved=0CA8QjRxqFwoTCNiSlISrr_sCFQAAAAAdAAAAABAD```

