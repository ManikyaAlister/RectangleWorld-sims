---
title: "Posterior Distributions Over Hypotheses for Different Learners"
author: "Manikya Alister"
date: "2023-01-12"
output: 
  html_document:
    code_folding: hide
---

Looks like there is a bit of an identifiability problem, particularly for the random condition. Specifically, there are very few rectangles where, if they were chosen by the participant, it would be most probable that they were from a participant responding randomly. 


This would make it difficult to fit participant responses by calculating which alpha was *most likely* to generate the participants guess. 

```{r echo = FALSE, message = FALSE}
rm(list = ls())
library(here)
# Plot posterior probability of rectangles given target block points in each condition
source(here("getLearnerHypDistributions.R"))
# load data 
load(here("experiment-scenarios/target-blocks/data/target-trial-1-Cartesian.Rdata"))

observations = targetTrial1$observations

trustingLearner = getLearnerHypDistribution(observations, alpha = 1, nTrials = 4, prior = "flat")
susLearner = getLearnerHypDistribution(observations, alpha = -1, nTrials = 4, prior = "flat")
randomLearner = getLearnerHypDistribution(observations, alpha = 0, nTrials = 4, prior = "flat")
```


```{r}
# 1 observation

trustingLearner1 = trustingLearner[[1]]
susLearner1 = susLearner[[1]]
randomLearner1 = randomLearner[[1]]

# Order rectangle size
size1orderedIndex <- order(trustingLearner1[,"size"], decreasing = TRUE)
size1ordered <- trustingLearner1[size1orderedIndex, "size"]

# combine different learners to 1 data frame
combined1 <- cbind(susLearner1[,"posterior"], trustingLearner1[,"posterior"], randomLearner1[,"posterior"])

# Order by rectangle size
ordered1 <- combined1[size1orderedIndex,]


```

```{r}
# 2 observations
trustingLearner2 = trustingLearner[[2]]
susLearner2 = susLearner[[2]]
randomLearner2 = randomLearner[[2]]

# Order rectangle size
size2orderedIndex <- order(trustingLearner2[,"size"], decreasing = TRUE)
size2ordered <- trustingLearner2[size2orderedIndex, "size"]


# combine different learners to 1 data frame
combined2<- cbind(susLearner2[,"posterior"], trustingLearner2[,"posterior"], randomLearner2[,"posterior"])
# Order by the trusting learner's posterior
ordered2 <- combined2[size2orderedIndex,]
```

```{r}
# 3 observations
trustingLearner3 = trustingLearner[[3]]
susLearner3 = susLearner[[3]]
randomLearner3 = randomLearner[[3]]

# Order rectangle size
size3orderedIndex <- order(trustingLearner3[,"size"], decreasing = TRUE)
size3ordered <- trustingLearner3[size2orderedIndex, "size"]


# combine different learners to 1 data frame
combined3<- cbind(susLearner3[,"posterior"], trustingLearner3[,"posterior"], randomLearner3[,"posterior"])
# Order by the trusting learner's posterior
ordered3 <- combined3[size3orderedIndex,]
```

```{r}
# 4 observations
trustingLearner4 = trustingLearner[[4]]
susLearner4 = susLearner[[4]]
randomLearner4 = randomLearner[[4]]

# Order rectangle size
size4orderedIndex <- order(trustingLearner4[,"size"], decreasing = TRUE)
size4ordered <- trustingLearner4[size4orderedIndex, "size"]


# combine different learners to 1 data frame
combined4<- cbind(susLearner4[,"posterior"], trustingLearner4[,"posterior"], randomLearner4[,"posterior"])
# Order by the trusting learner's posterior
ordered4 <- combined4[size4orderedIndex,]

```

```{r}
# Plot 

par(mfrow = c(2,2))


plot(size1ordered,ordered1[,1], type = "l", ylim = c(0,0.005), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size1ordered,ordered1[,2], col = "green")
lines(size1ordered,ordered1[,3], col = "blue")
mtext("1st clue, positive")

plot(size2ordered,ordered2[,1], type = "l", ylim = c(0,0.05), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size2ordered,ordered2[,2], col = "green")
lines(size2ordered,ordered2[,3], col = "blue")
mtext("2nd clue, positive")

plot(size3ordered,ordered3[,1], type = "l", ylim = c(0,0.05), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size3ordered,ordered3[,2], col = "green")
lines(size3ordered,ordered3[,3], col = "blue")
mtext("3rd clue, positive")

plot(size4ordered,ordered4[,1], type = "l", ylim = c(0,0.1), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size4ordered,ordered4[,2], col = "green")
lines(size4ordered,ordered4[,3], col = "blue")
mtext("4th clue, negative")
```

What about for another set of responses? Responses that weren't as alligned with how a helpful provider would choose points? 

```{r}
observations = data.frame(x = c(2.5,4.5,2.5,2.5), y = c(2.5,4.5,4.5,1.5), category = c("positive", "positive", "positive", "negative"))

trustingLearner = getLearnerHypDistribution(observations, alpha = 1, nTrials = 4, prior = "flat")
susLearner = getLearnerHypDistribution(observations, alpha = -1, nTrials = 4, prior = "flat")
randomLearner = getLearnerHypDistribution(observations, alpha = 0, nTrials = 4, prior = "flat")
```


```{r}
# 1 observation

trustingLearner1 = trustingLearner[[1]]
susLearner1 = susLearner[[1]]
randomLearner1 = randomLearner[[1]]

# Order rectangle size
size1orderedIndex <- order(trustingLearner1[,"size"], decreasing = TRUE)
size1ordered <- trustingLearner1[size1orderedIndex, "size"]

# combine different learners to 1 data frame
combined1 <- cbind(susLearner1[,"posterior"], trustingLearner1[,"posterior"], randomLearner1[,"posterior"])

# Order by rectangle size
ordered1 <- combined1[size1orderedIndex,]


```

```{r}
# 2 observations
trustingLearner2 = trustingLearner[[2]]
susLearner2 = susLearner[[2]]
randomLearner2 = randomLearner[[2]]

# Order rectangle size
size2orderedIndex <- order(trustingLearner2[,"size"], decreasing = TRUE)
size2ordered <- trustingLearner2[size2orderedIndex, "size"]


# combine different learners to 1 data frame
combined2<- cbind(susLearner2[,"posterior"], trustingLearner2[,"posterior"], randomLearner2[,"posterior"])
# Order by the trusting learner's posterior
ordered2 <- combined2[size2orderedIndex,]
```

```{r}
# 3 observations
trustingLearner3 = trustingLearner[[3]]
susLearner3 = susLearner[[3]]
randomLearner3 = randomLearner[[3]]

# Order rectangle size
size3orderedIndex <- order(trustingLearner3[,"size"], decreasing = TRUE)
size3ordered <- trustingLearner3[size2orderedIndex, "size"]


# combine different learners to 1 data frame
combined3<- cbind(susLearner3[,"posterior"], trustingLearner3[,"posterior"], randomLearner3[,"posterior"])
# Order by the trusting learner's posterior
ordered3 <- combined3[size3orderedIndex,]
```

```{r}
# 4 observations
trustingLearner4 = trustingLearner[[4]]
susLearner4 = susLearner[[4]]
randomLearner4 = randomLearner[[4]]

# Order rectangle size
size4orderedIndex <- order(trustingLearner4[,"size"], decreasing = TRUE)
size4ordered <- trustingLearner4[size4orderedIndex, "size"]


# combine different learners to 1 data frame
combined4<- cbind(susLearner4[,"posterior"], trustingLearner4[,"posterior"], randomLearner4[,"posterior"])
# Order by the trusting learner's posterior
ordered4 <- combined4[size4orderedIndex,]

```

```{r}
# Plot 

par(mfrow = c(2,2))


plot(size1ordered,ordered1[,1], type = "l", ylim = c(0,0.005), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size1ordered,ordered1[,2], col = "green")
lines(size1ordered,ordered1[,3], col = "blue")
mtext("1st clue, positive")

plot(size2ordered,ordered2[,1], type = "l", ylim = c(0,0.05), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size2ordered,ordered2[,2], col = "green")
lines(size2ordered,ordered2[,3], col = "blue")
mtext("2nd clue, positive")

plot(size3ordered,ordered3[,1], type = "l", ylim = c(0,0.05), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size3ordered,ordered3[,2], col = "green")
lines(size3ordered,ordered3[,3], col = "blue")
mtext("3rd clue, positive")

plot(size4ordered,ordered4[,1], type = "l", ylim = c(0,0.1), col = "red", ylab = "Posterior", xlab = "Rectangle (ordered by size)")
lines(size4ordered,ordered4[,2], col = "green")
lines(size4ordered,ordered4[,3], col = "blue")
mtext("4th clue, negative")
```






